(() => {

const exports = {};
const module = {exports};

var parcelRequire = function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"YBDT":[function(require,module,exports) {
const e=()=>{},t=(e,t)=>{if(!e)throw new Error(t)},n=e=>e&&"object"==typeof e&&!Array.isArray(e),r=(e,t)=>typeof e==typeof t?e>t:"string"==typeof e&&"number"==typeof t,l=(e,t)=>{for(let n in e)t.write(n,e[n])};function s(e=null){let i,o=[],h=[],u=-1,c=e,g=-1;const p=()=>{t(o.length===h.length/2),0===g?o.length?(u=h.pop(),c=o.pop(),g=h.pop()):(u=0,g=-1):(t(g>0),n(c[--g])&&g--)},a=()=>{const e=[];let t=c,r=o.length-1,l=g;for(;l>=0;)e.unshift(t[l]),0===l?(l=h[2*r],t=o[r--]):l-=n(t[l-1])?2:1;return e};return{read:()=>({ascend:p,getPath:a,get:()=>c?c.slice(g+1):null,getKey:()=>c[g],getComponent(){let e;return c&&c.length>g+1&&n(e=c[g+1])?e:null},descendFirst(){let e=g+1;if(!c||e>=c.length||n(c[e])&&e+1>=c.length)return!1;n(c[e])&&e++;let t=c[e];return Array.isArray(t)?(h.push(g),o.push(c),h.push(e),g=0,c=t):g=e,!0},nextSibling(){if(t(o.length===h.length/2),g>0||0===o.length)return!1;const e=h[h.length-1]+1,n=o[o.length-1];return!(e>=n.length)&&(t(!isNaN(e)),h[h.length-1]=e,c=n[e],!0)},_init(e,t,n,r){c=e,g=t,o=n.slice(),h=r.slice()},clone(){const e=s(null).read();return e._init(c,g,o,h),e},*[Symbol.iterator](){if(this.descendFirst()){do{yield this.getKey()}while(this.nextSibling());p()}},traverse(e,t){const n=this.getComponent();n&&t(n,e);for(const r of this)e&&e.descend(r),this.traverse(e,t),e&&e.ascend()},eachPick(e,t){this.traverse(e,(e,n)=>{null!=e.p&&t(e.p,n)})},eachDrop(e,t){this.traverse(e,(e,n)=>{null!=e.d&&t(e.d,n)})}}),write(){return i=[],{reset(){u=-1},getComponent(){!function(){t(o.length===h.length/2),null===c&&(e=c=[]);for(let e=0;e<i.length;e++){const l=i[e];let s=g+1;if(s<c.length&&n(c[s])&&s++,t(s===c.length||!n(c[s])),s===c.length)c.push(l),g=s;else if(c[s]===l)g=s;else{if(!Array.isArray(c[s])){const e=c.splice(s,c.length-s);c.push(e),u>-1&&(u=s)}for(h.push(g),o.push(c),-1!==u&&(t(r(l,c[u][0])),s=u+1,u=-1);s<c.length&&r(l,c[s][0]);)s++;if(h.push(s),g=0,s<c.length&&c[s][0]===l)c=c[s];else{const e=[l];c.splice(s,0,e),c=e}}}i.length=0}();const l=g+1;if(l<c.length&&n(c[l]))return c[l];{const e={};return c.splice(l,0,e),e}},write(e,n){const r=this.getComponent();t(null==r[e]||r[e]===n,"Internal consistency error: Overwritten component. File a bug"),r[e]=n},get:()=>e,descend(e){i.push(e)},descendPath(e){return i.push(...e),this},ascend(){i.length?i.pop():p()},mergeTree(n,r=l){if(null===n)return;if(t(Array.isArray(n)),n===e)throw Error("Cannot merge into my own tree");const s=u,i=o.length;let h=0;for(let e=0;e<n.length;e++){const t=n[e];"string"==typeof t||"number"==typeof t?(h++,this.descend(t)):Array.isArray(t)?this.mergeTree(t,r):"object"==typeof t&&r(t,this)}for(;h--;)this.ascend();u=o.length===i?s:-1},at(e,t){this.descendPath(e),t(this);for(let n=0;n<e.length;n++)this.ascend();return this},writeAtPath(e,t,n){return this.at(e,()=>this.write(t,n)),this.reset(),this},writeMove(e,t,n=0){return this.writeAtPath(e,"p",n).writeAtPath(t,"d",n)},getPath(){const e=a();return e.push(...i),e}}}}}const i=exports.writeCursor=(()=>s().write()),o=exports.readCursor=(e=>s(e).read());exports.advancer=function(e,t,n){let l,s;function i(l){let i;for(;s;){const o=i=e.getKey();if(null!=l){let n=!1;if(t&&"number"==typeof o&&(i=t(o,e.getComponent()))<0&&(i=~i,n=!0),r(i,l))return;if(i===l&&!n)return e}n&&"number"==typeof o&&n(i,e.getComponent()),s=e.nextSibling()}}return s=l=e&&e.descendFirst(),i.end=(()=>{l&&e.ascend()}),i},exports.eachChildOf=function(e,t,n){let l,s,i,o;for(l=s=e&&e.descendFirst(),i=o=t&&t.descendFirst();l||i;){let s=l?e.getKey():null,o=i?t.getKey():null;null!==s&&null!==o&&(r(o,s)?o=null:s!==o&&(s=null)),n(null==s?o:s,null!=s?e:null,null!=o?t:null),null!=s&&l&&(l=e.nextSibling()),null!=o&&i&&(i=t.nextSibling())}s&&e.ascend(),o&&t.ascend()};
},{}],"eFkX":[function(require,module,exports) {
function r(r,t){if(Array.isArray(t))return!1;for(let e in r)if(!n(r[e],t[e]))return!1;for(let n in t)if(void 0===r[n])return!1;return!0}function t(r,t){if(!Array.isArray(t))return!1;if(r.length!==t.length)return!1;for(let e=0;e<r.length;e++)if(!n(r[e],t[e]))return!1;return!0}function n(n,e){return n===e||null!==n&&null!==e&&("object"==typeof n&&"object"==typeof e&&(Array.isArray(n)?t(n,e):r(n,e)))}module.exports=n;
},{}],"TNQL":[function(require,module,exports) {
function r(n){if(null===n)return null;if(Array.isArray(n))return n.map(r);if("object"==typeof n){const t={};for(let e in n)t[e]=r(n[e]);return t}return n}module.exports=r;
},{}],"bU8t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.strPosToUni=((e,r=e.length)=>{let t=0,o=0;for(;o<r;o++){e.charCodeAt(o)>=55296&&(t++,o++)}if(o!==r)throw Error("Invalid offset - splits unicode bytes");return o-t}),exports.uniToStrPos=((e,r)=>{let t=0;for(;r>0;r--){t+=e.charCodeAt(t)>=55296?2:1}return t});
},{}],"L7F6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("unicount"),t=e=>{if(!Array.isArray(e))throw Error("Op must be an array of components");let t=null;for(let r=0;r<e.length;r++){const o=e[r];switch(typeof o){case"object":if(!("number"==typeof o.d&&o.d>0))throw Error("Object components must be deletes of size > 0");break;case"string":if(!(o.length>0))throw Error("Inserts cannot be empty");break;case"number":if(!(o>0))throw Error("Skip components must be >0");if("number"==typeof t)throw Error("Adjacent skip components should be combined")}t=o}if("number"==typeof t)throw Error("Op has a trailing skip")},r=e=>{const t=[],r=n(t);for(let o=0;o<e.length;o++)r(e[o]);return c(t)},o=e=>{if("number"!=typeof e&&("number"!=typeof e[0]||"number"!=typeof e[1]))throw Error("Invalid selection")},n=e=>t=>{t&&0!==t.d&&(0===e.length?e.push(t):typeof t==typeof e[e.length-1]?"object"==typeof t?e[e.length-1].d+=t.d:e[e.length-1]+=t:e.push(t))},s=t=>"number"==typeof t?t:"string"==typeof t?e.strPosToUni(t):t.d,i=t=>{let r=0,o=0;return{take:(n,s)=>{if(r===t.length)return-1===n?null:n;const i=t[r];let c;if("number"==typeof i)return-1===n||i-o<=n?(c=i-o,++r,o=0,c):(o+=n,n);if("string"==typeof i){if(-1===n||"i"===s||e.strPosToUni(i.slice(o))<=n)return c=i.slice(o),++r,o=0,c;{const t=o+e.uniToStrPos(i.slice(o),n);return c=i.slice(o,t),o=t,c}}return-1===n||"d"===s||i.d-o<=n?(c={d:i.d-o},++r,o=0,c):(o+=n,{d:n})},peek:()=>t[r]}},c=e=>(e.length>0&&"number"==typeof e[e.length-1]&&e.pop(),e);function a(r,o,a){if("left"!==a&&"right"!==a)throw Error("side ("+a+") must be 'left' or 'right'");t(r),t(o);const f=[],u=n(f),{take:p,peek:l}=i(r);for(let t=0;t<o.length;t++){const r=o[t];let n,i;switch(typeof r){case"number":for(n=r;n>0;)u(i=p(n,"i")),"string"!=typeof i&&(n-=s(i));break;case"string":"left"===a&&"string"==typeof l()&&u(p(-1)),u(e.strPosToUni(r));break;case"object":for(n=r.d;n>0;)switch(typeof(i=p(n,"i"))){case"number":n-=i;break;case"string":u(i);break;case"object":n-=i.d}}}let b;for(;b=p(-1);)u(b);return c(f)}function f(r,o){t(r),t(o);const a=[],f=n(a),{take:u}=i(r);for(let t=0;t<o.length;t++){const r=o[t];let n,i;switch(typeof r){case"number":for(n=r;n>0;)f(i=u(n,"d")),"object"!=typeof i&&(n-=s(i));break;case"string":f(r);break;case"object":for(n=r.d;n>0;)switch(typeof(i=u(n,"d"))){case"number":f({d:i}),n-=i;break;case"string":n-=e.strPosToUni(i);break;case"object":f(i)}}}let p;for(;p=u(-1);)f(p);return c(a)}const u=(t,r)=>{let o=0;for(let n=0;n<r.length&&t>o;n++){const s=r[n];switch(typeof s){case"number":o+=s;break;case"string":const r=e.strPosToUni(s);o+=r,t+=r;break;case"object":t-=Math.min(s.d,t-o)}}return t},p=(e,t)=>"number"==typeof e?u(e,t):e.map(e=>u(e,t));function l(e){return{name:"text-unicode",uri:"http://sharejs.org/types/text-unicode",trim:c,normalize:r,checkOp:t,create(t=""){if("string"!=typeof t)throw Error("Initial data must be a string");return e.create(t)},apply(r,o){t(o);const n=e.builder(r);for(let e=0;e<o.length;e++){const t=o[e];switch(typeof t){case"number":n.skip(t);break;case"string":n.append(t);break;case"object":n.del(t.d)}}return n.build()},transform:a,compose:f,transformPosition:u,transformSelection:p}}exports.default=l;
},{"unicount":"bU8t"}],"caPj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("unicount");function t(t,n){return{get:t,getLength:()=>t().length,insert(o,r,s){const i=e.strPosToUni(t(),o);return n([i,r],s)},remove(o,r,s){const i=e.strPosToUni(t(),o);return n([i,{d:r}],s)},_onOp(e){for(var t=0,n=0;n<e.length;n++){var o=e[n];switch(typeof o){case"number":t+=o,o;break;case"string":this.onInsert&&this.onInsert(t,o),t+=o.length;break;case"object":this.onRemove&&this.onRemove(t,o.d),o.d}}},onInsert:null,onRemove:null}}exports.default=t,t.provides={text:!0};
},{"unicount":"bU8t"}],"IMP5":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const t=require("unicount"),r=e(require("./maketext")),i=e(require("./api")),o={create:e=>e,toString:e=>e,builder(e){if("string"!=typeof e)throw Error("Invalid document snapshot: "+e);const r=[];return{skip(i){let o=t.uniToStrPos(e,i);if(o>e.length)throw Error("The op is too long for this document");r.push(e.slice(0,o)),e=e.slice(o)},append(e){r.push(e)},del(r){e=e.slice(t.uniToStrPos(e,r))},build:()=>r.join("")+e}}},s=r.default(o),u=Object.assign({},s,{api:i.default});exports.type=u;var n=require("./maketext");exports.makeType=n.default;
},{"unicount":"bU8t","./maketext":"L7F6","./api":"caPj"}],"iIAs":[function(require,module,exports) {
const e=!0,t=()=>{},{readCursor:n,writeCursor:l,advancer:o,eachChildOf:r}=require("./cursor"),i=require("./deepEqual"),s=require("./deepClone"),c=(e,t)=>{if(!e)throw new Error(t)};let u=!1;const f=exports.type={name:"json1",uri:"http://sharejs.org/types/JSONv1",readCursor:n,writeCursor:l,create:e=>e,setDebug(e){u=e,t.quiet=!e}},p=e=>e?e.getComponent():null,a=e=>e&&"object"==typeof e&&!Array.isArray(e),d=e=>Array.isArray(e)?e.slice():null!==e&&"object"==typeof e?Object.assign({},e):e,g=e=>e&&(null!=e.p||void 0!==e.r),y=e=>e&&(null!=e.d||void 0!==e.i),m=exports.removeOp=((e,t=!0)=>l().writeAtPath(e,"r",t).get()),h=exports.moveOp=((e,t)=>l().writeMove(e,t).get()),v=exports.insertOp=((e,t)=>l().writeAtPath(e,"i",t).get()),b=exports.replaceOp=((e,t,n)=>l().at(e,e=>{e.write("r",t),e.write("i",n)}).get()),w=exports.editOp=((e,t,n)=>l().at(e,e=>S(e,t,n)).get());function C(e,t){return c(null!=e),"number"==typeof t?(c(Array.isArray(e)),(e=e.slice()).splice(t,1)):(c(a(e)),delete(e=Object.assign({},e))[t]),e}function P(e,t,n){return"number"==typeof t?(c(Array.isArray(e),"Cannot use numerical key for object container"),e.splice(t,0,n)):(c(a(e),"Cannot insert into missing item"),c(void 0===e[t],"Trying to overwrite value at key. Your op needs to remove it first"),e[t]=n),n}const k=(e,t,n)=>((e=d(e))[t]=n,e),A={},E=f.registerSubtype=function(e){e.type&&(e=e.type),e.name&&(A[e.name]=e),e.uri&&(A[e.uri]=e)},O=e=>{const t=A[e];if(t)return t;throw Error("Missing type: "+e)};E(require("ot-text-unicode"));const x=(e,t)=>e+t;E({name:"number",apply:x,compose:x,transform:e=>e});const j=e=>null==e?null:e.et?O(e.et):e.es?A["text-unicode"]:null!=e.ena?A.number:null,T=e=>e.es?e.es:null!=e.ena?e.ena:e.e,S=(e,t,n)=>{"object"==typeof t&&(t=t.name),"number"===t?e.write("ena",n):"text-unicode"===t?e.write("es",n):(e.write("et",t),e.write("e",n))},q=e=>{c("number"==typeof e),c(e>=0),c(e===(0|e))},K=e=>{"number"==typeof e?q(e):c("string"==typeof e)},M=f.checkValidOp=function(e){if(null===e)return;const t=new Set,n=new Set,l=e=>{let l=!0,o=!1;for(let r in e){const i=e[r];if(l=!1,c("p"===r||"r"===r||"d"===r||"i"===r||"e"===r||"es"===r||"ena"===r||"et"===r,"Invalid component item '"+r+"'"),"p"===r)q(i),c(!t.has(i)),t.add(i),c(void 0===e.r);else if("d"===r)q(i),c(!n.has(i)),n.add(i),c(void 0===e.i);else if("e"===r||"es"===r||"ena"===r){c(!o),o=!0;const t=j(e);c(t,"Missing type in edit"),t.checkValidOp&&t.checkValidOp(T(e))}}c(!l)},o=(e,t,n)=>{if(!Array.isArray(e))throw Error("Op must be null or a list");if(0===e.length)throw Error("Empty descent");t||K(e[0]);let r=1,i=0,s=0;for(let u=0;u<e.length;u++){const t=e[u];if(c(null!=t),Array.isArray(t)){const e=o(t,!1,n);if(i){const t=typeof s,n=typeof e;t===n?c(s<e,"descent keys are not in order"):c("number"===t&&"string"===n)}s=e,i++,r=3}else"object"==typeof t?(c(1===r,`Prev not scalar - instead ${r}`),l(t),r=2):(c(3!==r),K(t),r=1)}return c(1!==i),c(2===r||3===r),e[0]};o(e,!0,!1),c(t.size===n.size,"Mismatched picks and drops in op");for(let r=0;r<t.size;r++)c(t.has(r)),c(n.has(r))},z=f.normalize=function(e){let t=0,n=[];const o=l();return o.mergeTree(e,(e,l)=>{const o=j(e);if(o){const t=T(e);S(l,o,o.normalize?o.normalize(t):t)}["r","p","i","d"].forEach(o=>{if(void 0!==e[o]){const r="p"===o||"d"===o?(e=>(null==n[e]&&(n[e]=t++),n[e]))(e[o]):e[o];l.write(o,r)}})}),o.get()};f.apply=function(e,n){if(t.quiet=!u,M(n),null===n)return e;const l=[];return function e(t,n){let o=t,r=0,i={root:t},s=0,c=i,u="root";function f(){for(;s<r;s++){let e=n[s];"object"!=typeof e&&(c=c[u]=d(c[u]),u=e)}}for(;r<n.length;r++){const t=n[r];if(Array.isArray(t)){const n=e(o,t);n!==o&&void 0!==n&&(f(),o=c[u]=n)}else if("object"==typeof t){null!=t.d?(f(),o=P(c,u,l[t.d])):void 0!==t.i&&(f(),o=P(c,u,t.i));const e=j(t);if(e)f(),o=c[u]=e.apply(o,T(t));else if(void 0!==t.e)throw Error("Subtype "+t.et+" undefined")}else o=null!=o?o[t]:void 0}return i.root}(e=function e(t,n){const o=[];let r=0;for(;r<n.length;r++){const e=n[r];if(Array.isArray(e))break;"object"!=typeof e&&(o.push(t),t=null==t?void 0:t[e])}for(let l=n.length-1;l>=r;l--)t=e(t,n[l]);for(--r;r>=0;r--){const e=n[r];if("object"!=typeof e){const n=o.pop();t=t===(null==n?void 0:n[e])?n:void 0===t?C(n,e):k(n,e,t)}else g(e)&&(c(void 0!==t,"Cannot pick up or remove undefined"),null!=e.p&&(l[e.p]=t),t=void 0)}return t}(e,n),n)};const D=()=>{},N=()=>{};f.transformPosition=((e,t)=>{e=e.slice(),M(t);const l=n(t);let r,i,s=!1;const c=[];for(let n=0;;n++){const t=e[n],u=l.getComponent();if(u&&(void 0!==u.r?s=!0:null!=u.p&&(s=!1,r=u.p,i=n)),n>=e.length)break;let f=0;const p=o(l,null,(e,t)=>{g(t)&&f++});c.unshift(p);const a=p(t);if("number"==typeof t&&(e[n]-=f),!a)break}if(c.forEach(e=>e.end()),s)return null;const u=()=>{let t=0;for(null!=r&&(t=i,e=l.getPath().concat(e.slice(i)));t<e.length;t++){const n=e[t],r=p(l),i=j(r);if(i){const n=T(r);i.transformPosition&&(e[t]=i.transformPosition(e[t],n));break}let s=0;const c=o(l,(e,t)=>y(t)?~(e-s):e-s,(e,t)=>{y(t)&&s++})(n);if("number"==typeof n&&(e[t]+=s),!c)break}};return null!=r?l.eachDrop(null,e=>{e===r&&u()}):u(),e});const _=(e,t,n)=>{"number"==typeof t?(c(Array.isArray(e)),c(t<e.length)):(c(!Array.isArray(e)),c(void 0!==e[t])),void 0===n?"number"==typeof t?e.splice(t,1):delete e[t]:e[t]=n},L=f.compose=function(e,t){if(M(e),M(t),null==e)return t;if(null==t)return e;let i=0;const s=n(e),u=n(t),f=l(),a=[],d=[],m=[],h=[],v=[],b=[];s.traverse(null,e=>{null!=e.p&&(m[e.p]=s.clone())}),u.traverse(null,e=>{null!=e.d&&(h[e.d]=u.clone())});const w=l();return function e(t,n,s,u,f,w,C,P){c(n||s);const k=p(n),A=p(s),E=A&&void 0!==A.r,O=k&&void 0!==k.i,x=k?k.d:null,q=A?A.p:null,K=(w||E)&&null==q;if(null!=q)u=h[q],C=d[q]=l();else if(A&&void 0!==A.r)u=null;else{const e=p(u);e&&null!=e.d&&(u=null)}const M=p(u);if(null!=x)if(t=m[x],P=a[x]=l(),K)w&&!E&&P.write("r",!0);else{const e=v[x]=i++;C.write("d",e)}else if(k&&void 0!==k.i)t=null;else{const e=p(t);e&&null!=e.p&&(t=null)}let z;O?(c(void 0===f),z=k.i):z=f;const D=(null==q?!O||w||E:void 0===z)?null:C.getComponent();if(null!=q)if(void 0!==f||O);else{const e=null!=x?v[x]:i++;b[q]=e,P.write("p",e)}else E&&(O||void 0!==f||(A.r,P.write("r",A.r)));const N=K?null:j(k),L=j(M);if((N||L)&&(N&&N.name,L&&L.name),N&&L){c(N===L);const e=T(k),t=T(M),n=N.compose(e,t);S(C,N,n)}else N?S(C,N,T(k)):L&&S(C,L,T(M));const I="object"==typeof z&&null!=z;let V=!1,F=0,R=0,U=0,B=0,H=0;const J=o(u,(e,t)=>y(t)?B-e-1:e-B,(e,t)=>{y(t)&&B++}),X=o(t,(e,t)=>g(t)?F-e-1:e-F,(e,t)=>{g(t)&&F++});if(r(n,s,(t,n,l)=>{let o,r,i=t,s=t,u=t;if("number"==typeof t){let e=t+U;r=J(e),s=e+B;let f=t+R;o=X(f),y(p(r))&&(o=null),u=t+H,c((i=f+F)>=0,"p1PickKey is negative"),c(s>=0,"p2DropKey is negative");const a=y(p(n)),d=g(p(l));(a||d&&!K)&&H--,a&&R--,d&&U--}else o=X(t),r=J(t);P.descend(i),C.descend(s);const f=I&&!y(p(n))?z[u]:void 0,a=e(o,n,l,r,f,K,C,P);I&&!K?f!==a&&(V||(z=Array.isArray(z)?z.slice():Object.assign({},z),V=!0),_(z,u,a)):c(void 0===a),C.ascend(),P.ascend()}),X.end(),J.end(),null!=D)D.i=z;else if(!w&&!E&&null==q)return z}(s,s.clone(),u,u.clone(),void 0,!1,f,w),f.reset(),f.mergeTree(w.get()),f.reset(),f.get(),a.map(e=>e.get()),d.map(e=>e.get()),s.traverse(f,(e,t)=>{const n=e.p;if(null!=n){const e=v[n];null!=e&&t.write("p",e);const l=a[n];l&&l.get(),l&&t.mergeTree(l.get())}else void 0!==e.r&&t.write("r",e.r)}),f.reset(),f.get(),u.traverse(f,(e,t)=>{const n=e.d;if(null!=n){const e=b[n];null!=e&&t.write("d",e);const l=d[n];l&&t.mergeTree(l.get())}else void 0!==e.i&&t.write("i",e.i);const l=j(e);l&&!j(t.getComponent())&&S(t,l,T(e))}),f.get()},I=0,V=1,F=e=>{if(null==e)return null;const t=e.slice();for(let n=0;n<e.length;n++)Array.isArray(t[n])&&(t[n]=F(t[n]));return t},R=f.RM_UNEXPECTED_CONTENT=1,U=f.DROP_COLLISION=2,B=f.BLACKHOLE=3,H=f.tryTransform=function(e,r,f){c("left"===f||"right"===f,"Direction must be left or right");const a="left"===f?0:1;if(t.quiet=!u,t.prefix=0,null==r)return{ok:!0,result:e};M(e),M(r);let d=null;const b=[],C=[],P=[],k=[],A=[],E=[],O=[],x=[],q=[],K=[],z=[],D=[],N=[],_=[],L=[];let I=0;const V=n(e),H=n(r),J=l();if(function e(t,n,l){const r=p(n);r&&(void 0!==r.r?l=n.clone():null!=r.p&&(l=null,E[r.p]=t.clone()));const i=t.getComponent();let s;i&&null!=(s=i.p)&&(A[s]=n?n.clone():null,P[s]=t.clone(),l&&(K[s]=!0,q[s]=l),r&&null!=r.p&&(_[s]=r.p));const c=o(n);for(const o of t)e(t,c(o),l);c.end()}(H,V,null),function e(t,n,l,r,i){const s=l.getComponent();let c,u=!1;s&&(null!=(c=s.d)?(k[c]=l.clone(),null==L[r]&&(L[r]=[]),L[r].push(c),K[c],t=A[c],n=P[c],K[c]?(i&&(z[c]=!0),i=q[c]):!i||1!==a&&null!=_[c]||null==d&&(d={type:R,op1:m(i.getPath()),op2:h(n.getPath(),l.getPath())}),u=!0):void 0!==s.i&&(t=n=null,u=!0,i&&null==d&&(d={type:R,op1:m(i.getPath()),op2:v(l.getPath(),s.i)})));const f=p(t);f&&(void 0!==f.r?i=t.clone():null!=f.p&&(f.p,r=f.p,i=null));const y=j(s);y&&i&&null==d&&(d={type:R,op1:m(i.getPath()),op2:w(l.getPath(),y,T(s))});let b=0,C=0;const E=o(n,(e,t)=>g(t)?b-e-1:e-b,(e,t)=>{g(t)&&b++}),O=o(t);for(const o of l)if("number"==typeof o){const t=o-C,n=E(t);C+=e(O(t+b),n,l,r,i)}else{const t=E(o);e(O(o),t,l,r,i)}return E.end(),O.end(),u}(V,H,H.clone(),null,null),k.map(e=>e&&e.get()),d)return{ok:!1,conflict:d};z.map(e=>!!e);const X=[];let Y=null;!function e(t,n,r,i,s){let u=!1;const f=p(n);if(g(f)){const e=f.p;null!=e?(r=k[e],i=D[e]=l(),u=!0,s=null):(r=null,s=n.clone())}else y(p(r))&&(r=null);const d=t.getComponent();if(d){const e=d.p;null!=e?(x[e]=s,X[e]=s||1===a&&u?null:i.getComponent(),b[e]=t.clone(),r&&(O[e]=r.clone())):void 0!==d.r&&(s||i.write("r",!0),(s||u)&&(null==Y&&(Y=new Set),Y.add(d)))}let m=0,h=0;const v=o(n,null,(e,t)=>{g(t)&&m++});v._name="2pick";const w=o(r,(e,t)=>y(t)?~(e-h):e-h,(e,t)=>{y(t)&&h++});if(w._name="2drop",t)for(const l of t)if("string"==typeof l){const n=v(l),o=w(l);i.descend(l),e(t,n,o,i,s),i.ascend()}else{const n=v(l),o=l-m,r=g(p(n))?null:w(o),u=o+h;c(u>=0),i.descend(u),e(t,n,r,i,s),i.ascend()}v.end(),w.end()}(V,H,H.clone(),J,null),J.reset();let $=[];if(function e(t,n,r,u,A,q){c(n);const M=n.getComponent();let z=p(u),D=!1;const L=(e,t,n)=>e?h(e.getPath(),t.getPath()):v(t.getPath(),n.i);if(y(M)){const e=M.d;null!=e&&(C[e]=n.clone());const l=null!=e?X[e]:null;let o=!1;if(void 0!==M.i||null!=e&&l){let t;z&&(void 0!==z.i||null!=(t=z.d)&&!K[z.d])&&((o=null!=t?null!=e&&e===_[t]:i(z.i,M.i))||null!=t&&1!==a&&null!=_[t]||null==d&&(d={type:U,op1:L(null!=e&&b[e],n,M),op2:L(null!=t&&P[t],u,z)})),o||(q?null==d&&(d={type:R,op1:L(null!=e?b[e]:null,n,M),op2:m(q.getPath())}):(null!=e?($[I]=e,A.write("d",l.p=I++)):A.write("i",s(M.i)),D=!0))}else if(null!=e&&!l){const t=x[e];t&&(q=t.clone())}null!=e?(t=b[e],r=E[e],u=O[e]):void 0!==M.i&&(t=r=null,o||(u=null))}else g(p(t))&&(t=r=u=null);const V=p(t),F=p(r);if(g(F)){const e=F.p;void 0!==F.r&&(!V||void 0===V.r)||K[e]?(u=null,q=r.clone()):null!=e&&(u=k[e],1!==a&&null!=_[e]||((A=N[e])||(A=N[e]=l()),A.reset(),q=null))}else!y(M)&&y(z)&&(u=null);z=null!=u?u.getComponent():null;const B=j(M);if(B){const e=T(M);if(q)null==d&&(d={type:R,op1:w(n.getPath(),B,e),op2:m(q.getPath())});else{const t=j(z);let n;if(t){if(B!==t)throw Error("Transforming incompatible types");const l=T(z);n=B.transform(e,l,f)}else n=s(e);S(A,B,n)}}let H=0,J=0,G=0,Q=0,W=0,Z=0,ee=null!=t&&t.descendFirst(),te=ee;const ne=o(r,null,(e,t)=>{g(t)&&G++});ne._name="2p";let le=null!=u&&u.descendFirst(),oe=le;for(const l of n)if("number"==typeof l){let o;const r=y(n.getComponent()),i=l-J;{let e;for(;ee&&"number"==typeof(e=t.getKey());){e+=H;const n=t.getComponent(),l=g(n);if(e>i||e===i&&(!l||0===a&&r))break;if(l){H--;const e=n.p;X[e],_.includes(e),n.d,p(N[n.d]),g(p(N[n.d])),(void 0===n.r||Y&&Y.has(n))&&(null==e||!X[e]||1!==a&&_.includes(e))||W--}ee=t.nextSibling()}o=ee&&e===i?t:null}const s=i-H;let f=ne(s);const d=s-G;let m=null;{let e,t;for(;le&&"number"==typeof(e=u.getKey());){t=e-Q;const n=u.getComponent(),l=y(n);if(t>d)break;if(t===d){if(!l){m=u;break}{if(0===a&&r){m=u;break}const e=f&&g(f.getComponent());if(0===a&&e)break}}if(l){const e=n.d;K[e],_[e],void 0===n.i&&(K[e]||null!=_[e]&&1!==a)?(K[e]||null!=_[e]&&0===a)&&(Q++,Z--):Q++}le=u.nextSibling()}}const h=d+Q+W+Z;c(h>=0,"trying to descend to a negative index"),A.descend(h),r&&(o=f=m=null,J++),e(o,n,f,m,A,q)&&Z++,A.ascend()}else{let o;for(;ee&&("string"!=typeof(o=t.getKey())||!(o>l||o===l));)ee=t.nextSibling();const r=ee&&o===l?t:null,i=ne(l);let s;for(;le&&("string"!=typeof(s=u.getKey())||!(s>l||s===l));)le=u.nextSibling();const c=le&&s===l?u:null;A.descend(l),e(r,n,i,c,A,q),A.ascend(l)}return ne.end(),te&&t.ascend(),oe&&u.ascend(),D}(V,V.clone(),H,H.clone(),J,null),d)return{ok:!1,conflict:d};J.reset();const G=(e,t,n)=>e.traverse(t,(t,l)=>{null!=t.d&&n(t.d,e,l)});(K.length||D.length)&&(G(H,J,(e,t,n)=>{K[e]&&!z[e]&&n.write("r",!0),D[e]&&n.mergeTree(D[e].get())}),J.reset());const Q=[],W=[];if((N.length||K.length)&&!d){const e=n(F(J.get()));if(G(e,null,(e,t)=>{Q[e]=t.clone()}),N.forEach(e=>{e&&G(n(e.get()),null,(e,t)=>{Q[e]=t.clone()})}),function e(r,i,s,c,u,f){t.prefix++;const a=p(i);if(g(a))if(null!=a.p){u=a;const e=a.p;Q[e].getPath(),s=Q[e],c=W[e]=l()}else void 0!==a.r&&(s=null,f=!0);else y(p(s))&&(s=null);const d=r.getComponent();if(d){let e;if(null!=(e=d.d)){const e=N[d.d];e&&(e.get(),c.mergeTree(e.get()),s=n(e.get()))}}let m=0,h=0;const v=o(i,null,(e,t)=>{g(t)&&m--}),b=o(s,(e,t)=>y(t)?-(e-h)-1:e-h,(e,t)=>{y(t)&&h++});for(const t of r)if("number"==typeof t){const n=v(t),l=t+m,o=b(l),i=l+h;c.descend(i),e(r,n,o,c,u,f),c.ascend()}else c.descend(t),e(r,v(t),b(t),c,u,f),c.ascend();v.end(),b.end()}(H,e,e.clone(),J,null,!1),J.reset(),d)return{ok:!1,conflict:d};if(J.get(),W.length){const e=W.map(e=>e?e.get():null),t=n(F(J.get()));if(G(t,J,(t,n,l)=>{const o=e[t];o&&(l.mergeTree(o),e[t]=null)}),e.find(e=>e)){const t=l(),o=l();let r=0,i=0;e.forEach(e=>{null!=e&&G(n(e),null,e=>{const n=$[e];t.writeMove(b[n].getPath(),C[n].getPath(),r++);const l=L[n];l&&l.forEach(e=>{K[e]||1!==a&&null!=_[e]||o.writeMove(P[e].getPath(),k[e].getPath(),i++)})})}),d={type:B,op1:t.get(),op2:o.get()}}}}if(d)return{ok:!1,conflict:d};return{ok:!0,result:J.get()}},J=e=>{const t=new Error("Transform detected write conflict");throw t.conflict=e,t.type=t.name="writeConflict",t},X=f.transform=((e,t,n)=>{const{ok:l,result:o,conflict:r}=H(e,t,n);if(l)return o;J(r)}),Y=e=>{const t=l();return n(e).traverse(t,(e,t)=>{(y(e)||j(e))&&t.write("r",!0)}),t.get()},$=(e,t)=>{const{type:l,op1:o,op2:r}=e;switch(l){case U:return"left"===t?[null,Y(r)]:[Y(o),null];case R:let e=!1;return n(o).traverse(null,t=>{void 0!==t.r&&(e=!0)}),e?[null,Y(r)]:[Y(o),null];case B:return[Y(o),Y(r)];default:throw Error("Unrecognised conflict: "+l)}},G=({type:e,op1:t,op2:n})=>({type:e,op1:n,op2:t}),Q=({type:e,op1:t,op2:n})=>({type:e,op1:z(t),op2:z(n)}),W=(e,t,n,l)=>{let o=null;for(;;){const{ok:r,result:i,conflict:s}=H(t,n,l);if(r)return L(o,i);if(e(s)){const[e,r]=$(s,l);t=L(t,e),n=L(n,r),o=L(o,r)}else J(s)}};f.transformNoConflict=((e,t,n)=>W(()=>!0,e,t,n)),f.typeAllowingConflictsPred=(e=>({...f,transform:(t,n,l)=>W(e,t,n,l)}));
},{"./cursor":"YBDT","./deepEqual":"eFkX","./deepClone":"TNQL","ot-text-unicode":"IMP5"}]},{},["iIAs"], null)

window.json1 =  module.exports;

})();